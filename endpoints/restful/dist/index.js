!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("type-r")):"function"==typeof define&&define.amd?define(["exports","type-r"],e):e((t=t||self).restfulIO={},t.Nested)}(this,function(t,e){"use strict";var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function i(i,u,c,s){return new(c||(c=Promise))(function(t,e){function r(t){try{o(s.next(t))}catch(t){e(t)}}function n(t){try{o(s.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new c(function(t){t(e.value)}).then(r,n)}o((s=s.apply(i,u||[])).next())})}function u(r,n){var o,i,u,t,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(u=2&e[0]?i.return:e[0]?i.throw||((u=i.return)&&u.call(i),0):i.next)&&!(u=u.call(i,e[1])).done)return u;switch(i=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,i=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(u=0<(u=c.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){c.label=e[1];break}if(6===e[0]&&c.label<u[1]){c.label=u[1],u=e;break}if(u&&c.label<u[2]){c.label=u[2],c.ops.push(e);break}u[2]&&c.ops.pop(),c.trys.pop();continue}e=n.call(r,c)}catch(t){e=[6,t],i=0}finally{o=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(t,e){return new o(t,e)}var o=function(){function c(t,e){this.url=t,this.fetchOptions=e}return c.prototype.create=function(t,e,r){return this.request("POST",this.collectionUrl(r,e),e,t)},c.prototype.update=function(t,e,r,n){return this.request("PUT",this.objectUrl(n,t,r),r,e)},c.prototype.read=function(t,e,r){return this.request("GET",this.objectUrl(r,t,e),e)},c.prototype.destroy=function(t,e,r){return this.request("DELETE",this.objectUrl(r,t,e),e)},c.prototype.list=function(t,e){return this.request("GET",this.collectionUrl(e,t),t)},c.prototype.subscribe=function(t){},c.prototype.unsubscribe=function(t){},c.prototype.isRelativeUrl=function(t){return 0===t.indexOf("./")},c.prototype.removeTrailingSlash=function(t){return"/"===t.charAt(t.length-1)?t.substr(0,t.length-1):t},c.prototype.getRootUrl=function(t){var e=this.url;if(this.isRelativeUrl(e)){var r=t.getOwner(),n=r.getEndpoint().getUrl(r);return this.removeTrailingSlash(n)+"/"+e.substr(2)}return e},c.prototype.getUrl=function(t){var e=this.getRootUrl(t);return t.isNew()?e:this.removeTrailingSlash(e)+"/"+t.id},c.prototype.objectUrl=function(t,e,r){return f(this.getUrl(t),r.params)},c.prototype.collectionUrl=function(t,e){return f(this.getRootUrl(t),e.params)},c.prototype.buildRequestOptions=function(t,e,r){var n=s({},c.defaultFetchOptions,this.fetchOptions,e),o=n.headers,i=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&(r[n[o]]=t[n[o]])}return r}(n,["headers"]),u=s({method:t,headers:s({"Content-Type":"application/json"},o)},i);return r&&(u.body=JSON.stringify(r)),u},c.prototype.request=function(t,e,r,n){var o=r.options;return fetch(e,this.buildRequestOptions(t,o,n)).then(function(t){if(t.ok)return t.json();throw new Error(t.statusText)})},c.defaultFetchOptions={cache:"no-cache",credentials:"same-origin",mode:"cors",redirect:"error"},c}();function f(t,e){var r=encodeURIComponent;return e?t+"?"+Object.keys(e).map(function(t){return r(t)+"="+r(e[t])}).join("&"):t}function c(t){throw new ReferenceError("Method "+t+" is not supported. modelFetchIO supports only model.fetch().")}var l=function(o){function t(t,e,r){var n=o.call(this,"",r)||this;return n.method=t,n.constructUrl=e,n}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(t,o),t.prototype.list=function(){return i(this,void 0,void 0,function(){return u(this,function(t){return c("collection.fetch()"),[2]})})},t.prototype.destroy=function(){return i(this,void 0,void 0,function(){return u(this,function(t){return c("model.destroy()"),[2]})})},t.prototype.create=function(){return i(this,void 0,void 0,function(){return u(this,function(t){return c("model.save()"),[2]})})},t.prototype.update=function(){return i(this,void 0,void 0,function(){return u(this,function(t){return c("model.save()"),[2]})})},t.prototype.read=function(t,e,r){return i(this,void 0,void 0,function(){return u(this,function(t){return this.url=this.constructUrl(e.params,r),[2,this.request(this.method,this.getRootUrl(r),e)]})})},t=function(t,e,r,n){var o,i=arguments.length,u=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;0<=c;c--)(o=t[c])&&(u=(i<3?o(u):3<i?o(e,r,u):o(e,r))||u);return 3<i&&u&&Object.defineProperty(e,r,u),u}([e.define],t)}(o);t.create=r,t.restfulIO=r,t.RestfulEndpoint=o,t.fetchModelIO=function(t,e,r){return new l(t,e,r)},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
